/**
 * V4 Adaptive Assessment - Xiaoyue Feedback System
 * 小悦反馈系统 - 生动版（69题完整版）
 */

import { TraitKey } from './types';

export interface OptionFeedback {
  text: string;
  traitHints: TraitKey[];
}

export interface QuestionFeedbackConfig {
  questionId: string;
  options: Record<string, OptionFeedback>;
}

export const xiaoyueFeedback: Record<string, Record<string, string>> = {
  // ============ L1: 基础枢纽题 (Q1-Q15) ============
  "Q1": {
    "A": "破冰专家上线。记下了。",
    "B": "先看看安排，很谨慎嘛。",
    "C": "婉拒得挺得体。行。",
    "D": "礼貌回避，有自己的节奏。"
  },
  "Q2": {
    "A": "都可以啊，随和派。",
    "B": "还查评分表？够严谨。",
    "C": "选最特别的，冒险家。",
    "D": "安静聊天，喜欢深度。"
  },
  "Q3": {
    "A": "太棒了！立刻调整计划，这种热情真有感染力。",
    "B": "坚守计划，执行力强。",
    "C": "想拉朋友一起，会协调。",
    "D": "需要消化冲突，理解。"
  },
  "Q4": {
    "A": "直接开干，行动派选手。",
    "B": "一步步问清楚，严谨型。",
    "C": "先看一局，观察者。",
    "D": "看懂了再加入，谨慎入场。"
  },
  "Q5": {
    "A": "指挥全场，掌控型。",
    "B": "照顾他人，贴心派。",
    "C": "配合大家，随和型。",
    "D": "低调站边，内敛派。"
  },
  "Q6": {
    "A": "直接提优化，效率派。",
    "B": "私聊提建议，很周到。",
    "C": "按大家的来，随和型。",
    "D": "只告诉一两人，低调。"
  },
  "Q7": {
    "A": "直接抛出观点，不怯场。",
    "B": "观察时机再提，很稳。",
    "C": "私下分享，注重关系。",
    "D": "保护气氛，谨慎型。"
  },
  "Q8": {
    "A": "有点焦躁，希望推进。",
    "B": "正好多认识人，积极派。",
    "C": "默默总结疏漏，分析型。",
    "D": "完全放空，佛系等待。"
  },
  "Q9": {
    "A": "第一个举手，勇者。",
    "B": "等别人陪，抱团型。",
    "C": "坚决不上，回避表现。",
    "D": "起哄别人上，气氛组。"
  },
  "Q10": {
    "A": "雨中玩耍，探险精神。",
    "B": "赶紧找备用方案，可靠。",
    "C": "等组织者处理，随和。",
    "D": "正好取消，解脱派。"
  },
  "Q11": {
    "A": "发自我介绍，主动型。",
    "B": "默默围观，观察者。",
    "C": "看活跃者资料，好奇。",
    "D": "设置免打扰，省电模式。"
  },
  "Q12": {
    "A": "随便都行，随和派。",
    "B": "查评分再定，分析派。",
    "C": "尝尝鲜，探索派。",
    "D": "跟着朋友走，省心。"
  },
  "Q13": {
    "A": "投其所好，用心派。",
    "B": "分享品味，独特派。",
    "C": "实用好物，稳妥派。",
    "D": "手工心意，走心派。"
  },
  "Q14": {
    "A": "开心延续联系，热情。",
    "B": "平常心聊天，自然派。",
    "C": "斟酌回复，谨慎型。",
    "D": "喜欢有目的的交流。"
  },
  "Q15": {
    "A": "欢呼庆祝，享受胜利。",
    "B": "主动击掌，照顾对手。",
    "C": "分析胜负原因，复盘型。",
    "D": "低调避免刺激，体谅。"
  },
  
  // ============ L2: 核心探索题 (Q16-Q50) ============
  "Q16": {
    "A": "专注倾听，情感支持型。",
    "B": "帮ta梳理步骤，解决方案派。",
    "C": "分享类似经历，共鸣型。",
    "D": "提议分散注意力，转移派。"
  },
  "Q17": {
    "A": "立刻组队探险，行动派。",
    "B": "研究背后的故事，深度型。",
    "C": "收藏等合适时机，谨慎分享。",
    "D": "自己先体验，独立型。"
  },
  "Q18": {
    "A": "完全独处回血，耗尽了。",
    "B": "线上继续回味，能量持续。",
    "C": "小范围复盘，有始有终。",
    "D": "低刺激独处，慢慢恢复。"
  },
  "Q19": {
    "A": "直接给答案，效率高。",
    "B": "鼓励并@别人，连接者。",
    "C": "私聊告诉，避免刷屏。",
    "D": "默默点赞，观察者。"
  },
  "Q20": {
    "A": "委婉纠正，严谨型。",
    "B": "一笑置之，包容派。",
    "C": "私下提醒，体贴周到。",
    "D": "开玩笑化解，幽默型。"
  },
  "Q21": {
    "A": "兴奋利用规则，策略家。",
    "B": "先确认规则，避免争议。",
    "C": "犹豫怕破坏平衡，体贴。",
    "D": "按常规玩，随和派。"
  },
  "Q22": {
    "A": "发起投票，民主派。",
    "B": "自己分析决定，果断。",
    "C": "私下协调核心朋友，细腻。",
    "D": "让积极者决定，配合型。"
  },
  "Q23": {
    "A": "主动自我介绍，不怯场。",
    "B": "紧跟朋友，借力型。",
    "C": "先观察再融入，谨慎。",
    "D": "等别人主动找，随缘型。"
  },
  "Q24": {
    "A": "点热门歌曲，跟潮流。",
    "B": "点拿手曲目，表现型。",
    "C": "点冷门好歌，分享派。",
    "D": "点最简单的，低调。"
  },
  "Q25": {
    "A": "幽默化解僵局，气氛组。",
    "B": "私下调解，和平使者。",
    "C": "观察事态发展，谨慎。",
    "D": "暂时离开，回避冲突。"
  },
  "Q26": {
    "A": "气氛活跃者，创意贡献。",
    "B": "组织协调者，连接资源。",
    "C": "深度参与者，知识提供。",
    "D": "稳定支持者，可靠后盾。"
  },
  "Q27": {
    "A": "大量短平快点子，创意爆发。",
    "B": "几个可行方案，务实派。",
    "C": "深入系统框架，思考型。",
    "D": "补充优化别人，配合者。"
  },
  "Q28": {
    "A": "会反思表达，心思细腻。",
    "B": "无所谓，淡定派。",
    "C": "主动@救场，积极型。",
    "D": "反思表达方式，严谨。"
  },
  "Q29": {
    "A": "惊喜感动，情感丰富。",
    "B": "兴奋大笑，享受关注。",
    "C": "有点意外但配合，随和型。",
    "D": "惊喜有点意外，需要消化。"
  },
  "Q30": {
    "A": "认真提建议，负责型。",
    "B": "写鼓励赞美，阳光派。",
    "C": "简单勾选评分，省事。",
    "D": "不填除非有强烈感受。"
  },
  "Q31": {
    "A": "推销自己风格，说服者。",
    "B": "协调折中方案，和事佬。",
    "C": "分析利弊数据，理性派。",
    "D": "都可以，随和型。"
  },
  "Q32": {
    "A": "选大冒险，刺激派。",
    "B": "选真心话，分享型。",
    "C": "根据熟悉程度决定，灵活。",
    "D": "选最简单安全的，谨慎。"
  },
  "Q33": {
    "A": "立刻尝试，好奇宝宝。",
    "B": "先查资料评价，研究型。",
    "C": "感谢但不会行动，谨慎。",
    "D": "答应体验一次，给面子。"
  },
  "Q34": {
    "A": "努力跟快组，挑战自我。",
    "B": "陪体力弱的人，照顾型。",
    "C": "按自己节奏走，自在派。",
    "D": "向领队建议调整，负责任。"
  },
  "Q35": {
    "A": "享受观点交锋，辩论型。",
    "B": "温和分享感受，包容派。",
    "C": "延伸哲学探讨，深度思考。",
    "D": "轻松聊天，不严肃。"
  },
  "Q36": {
    "A": "选安全通用礼品，稳妥。",
    "B": "悄悄了解喜好，用心。",
    "C": "选代表自己特色的，个性派。",
    "D": "选趣味互动礼物，好玩。"
  },
  "Q37": {
    "A": "帮列利弊分析，理性派。",
    "B": "先共情问需求，情感支持。",
    "C": "分享类似经历，共鸣型。",
    "D": "鼓励跟随直觉，支持者。"
  },
  "Q38": {
    "A": "渐入佳境，享受能量场。",
    "B": "需要透气休息，耗电快。",
    "C": "找小圈子聊天，舒适型。",
    "D": "能量快见底，想充电了。"
  },
  "Q39": {
    "A": "我来做！喜欢演讲。",
    "B": "准备内容让别人讲，幕后型。",
    "C": "协助演讲者，配合者。",
    "D": "尽量不参与展示，回避。"
  },
  "Q40": {
    "A": "知道很多人背景，社交广。",
    "B": "只和固定人熟，深度型。",
    "C": "和谁都能聊几句，灵活。",
    "D": "专注活动本身，任务导向。"
  },
  "Q41": {
    "A": "立刻热烈讨论，表达欲强。",
    "B": "先问朋友感受，倾听者。",
    "C": "简单分享感受，随和派。",
    "D": "需要时间消化，沉浸型。"
  },
  "Q42": {
    "A": "主动找共同话题，搭桥者。",
    "B": "努力找连接点，责任感强。",
    "C": "顺其自然，不强求。",
    "D": "开玩笑缓和气氛，幽默。"
  },
  "Q43": {
    "A": "提前几周有安排，社交忙人。",
    "B": "有固定活动，规律型。",
    "C": "更喜欢留白，需要独处。",
    "D": "策划深度小聚，质量派。"
  },
  "Q44": {
    "A": "直接问可以拒绝，干脆。",
    "B": "委婉提出会回报，周到。",
    "C": "纠结确保不添负担，体贴。",
    "D": "在心里筛选人选，理性。"
  },
  "Q45": {
    "A": "严格遵循步骤，完美主义。",
    "B": "加入自己创意，改造派。",
    "C": "和别人交流想法，合作型。",
    "D": "希望老师多指导，学习型。"
  },
  "Q46": {
    "A": "感到被挑战，更努力阐述。",
    "B": "想结束对峙，回避型。",
    "C": "好奇对方立场，探索者。",
    "D": "觉得正常，淡定派。"
  },
  "Q47": {
    "A": "热情洋溢祝福，阳光型。",
    "B": "私聊个人化祝贺，体贴。",
    "C": "简单点赞评论，低调。",
    "D": "记在心里见面说，实际派。"
  },
  "Q48": {
    "A": "碎片化搜索，广度学习。",
    "B": "找权威书籍系统学，深度。",
    "C": "找朋友讨论研究，社交学习。",
    "D": "兴趣淡了就不学，随性。"
  },
  "Q49": {
    "A": "每个摊位都看，全都要。",
    "B": "先绕场一周再选，策略型。",
    "C": "和朋友聊天为主，社交导向。",
    "D": "避开人群找角落，安静派。"
  },
  "Q50": {
    "A": "绝对保密，就当不知道。",
    "B": "告诉最信任的朋友，分享型。",
    "C": "以关心方式聊起，体贴。",
    "D": "有点纠结，需要消化。"
  },
  
  // ============ L3: 精准决胜题 (Q51-Q60) ============
  "Q51": {
    "A": "让气氛愉快，开心果型。",
    "B": "提供情感支持，治愈系。",
    "C": "提供独特视角，灵感源泉。",
    "D": "确保事情顺利，可靠后盾。"
  },
  "Q52": {
    "A": "不太喜欢冷场的感觉。",
    "B": "在意表达是否得体。",
    "C": "不喜欢突然成为焦点。",
    "D": "不太想卷入人际冲突。"
  },
  "Q53": {
    "A": "火花塞，点燃气氛。",
    "B": "粘合剂，连接大家。",
    "C": "指南针，提供方向。",
    "D": "观察者，洞察分析。"
  },
  "Q54": {
    "A": "做真实自己更重要。",
    "B": "让周围人舒服更重要。",
    "C": "看情况，灵活应对。",
    "D": "两者不冲突，刚好。"
  },
  "Q55": {
    "A": "经常是活动发起者。",
    "B": "更多是积极参与者。",
    "C": "倾向小型深度交流。",
    "D": "常以观察者身份加入。"
  },
  "Q56": {
    "A": "更擅长耐心倾听。",
    "B": "更擅长给出建议。",
    "C": "更擅长用乐观感染。",
    "D": "更擅长分享经历。"
  },
  "Q57": {
    "A": "放大笑点成经典梗，幽默家。",
    "B": "笑着去安慰朋友，体贴型。",
    "C": "看看是否尴尬再解围，细心。",
    "D": "跟着笑不突出，随和派。"
  },
  "Q58": {
    "A": "情绪接纳更消耗心力。",
    "B": "找解决方案更消耗心力。",
    "C": "都很乐意，不消耗。",
    "D": "帮助没效果时最消耗。"
  },
  "Q59": {
    "A": "非常敏锐，常第一个感觉到。",
    "B": "比较符合，但有时忽略。",
    "C": "更关注明确表达的内容。",
    "D": "很少注意这些细微变化。"
  },
  "Q60": {
    "A": "真诚深刻的连接理解。",
    "B": "新鲜感和创意惊喜。",
    "C": "大家玩得开心笑声不断。",
    "D": "安排得当流程顺畅舒适。",
    "E": "可以放松做自己没压力。"
  },

  // ============ 新增题目 (Q61-Q69) ============
  // Q61-Q62: 反向计分题
  "Q61": {
    "A": "有点烦躁，保护个人空间。",
    "B": "犹豫但还是会去，有责任感。",
    "C": "开心！正好想出去玩。",
    "D": "看情况，理性评估派。"
  },
  "Q62": {
    "A": "专注聊天，享受当下。",
    "B": "帮大家拍照，服务型。",
    "C": "积极参与，融入热闹。",
    "D": "找个安静角落，需要喘息。"
  },
  // Q63-Q65: E维度（情绪稳定性）直接测量题
  "Q63": {
    "A": "几秒钟就过去了，弹性好。",
    "B": "当时介意，很快就忘。",
    "C": "可能影响一段时间心情。",
    "D": "会反复想，深度消化型。"
  },
  "Q64": {
    "A": "深呼吸冷静，自我调节。",
    "B": "找人倾诉，需要出口。",
    "C": "默默处理，独自消化。",
    "D": "转移注意力，做别的事。"
  },
  "Q65": {
    "A": "第二天精神满满，恢复快。",
    "B": "需要半天缓冲，正常。",
    "C": "可能需要一整天恢复。",
    "D": "好几天都有点累。"
  },
  // Q66-Q68: 工作/学习场景题
  "Q66": {
    "A": "咖啡馆背景音，有氛围。",
    "B": "完全安静，专注型。",
    "C": "轻音乐陪伴，放松。",
    "D": "和朋友一起自习，互相督促。"
  },
  "Q67": {
    "A": "先开始再说，边做边调整。",
    "B": "列清单规划，有条理。",
    "C": "看心情，灵活安排。",
    "D": "设定奖励机制，激励自己。"
  },
  "Q68": {
    "A": "主动申请，喜欢挑战。",
    "B": "被安排也OK，配合型。",
    "C": "有点紧张但愿意试。",
    "D": "希望先观察别人怎么做。"
  },
  // Q69: 注意力检查题
  "Q69": {
    "A": "认真作答，选了这个。",
    "B": "看到了，选B。",
    "C": "收到指令，选C。",
    "D": "仔细看了，选D。"
  },
  // ============ 新增P维度题目 (Q70-Q74) ============
  "Q70": {
    "A": "冒险家！肾上腺素选手。",
    "B": "谨慎型冒险，稳中求刺激。",
    "C": "旁观支持型，安全第一。",
    "D": "诚实表达边界，有自知之明。"
  },
  "Q71": {
    "A": "胜负党，认真玩游戏。",
    "B": "气氛组！开心最重要。",
    "C": "观察者，人比游戏有趣。",
    "D": "佛系玩家，轻松就好。"
  },
  "Q72": {
    "A": "即兴王！舞台是你的。",
    "B": "先观察再行动，稳妥。",
    "C": "幕后支持，贡献氛围。",
    "D": "观众席最安全，理解。"
  },
  "Q73": {
    "A": "快乐源泉！继续抖包袱。",
    "B": "自然流露，不刻意。",
    "C": "无心插柳，意外之喜。",
    "D": "情绪平稳，不在意。"
  },
  "Q74": {
    "A": "期待派！享受悬念。",
    "B": "又期待又忐忑，复杂。",
    "C": "平常心，淡定派。",
    "D": "喜欢确定感，不爱等。"
  },
  // ============ 新增O维度题目 (Q75-Q77) ============
  "Q75": {
    "A": "好奇宝宝！新观点爱好者。",
    "B": "开放但要验证，严谨。",
    "C": "需要时间消化，谨慎。",
    "D": "对颠覆性观点保持怀疑。"
  },
  "Q76": {
    "A": "艺术爱好者，享受解读。",
    "B": "感受氛围，不求甚解。",
    "C": "陪伴型，愿意配合。",
    "D": "实用派，不太来电。"
  },
  "Q77": {
    "A": "随性探索者，享受未知。",
    "B": "有计划的冒险家。",
    "C": "稳妥型，降低踩雷风险。",
    "D": "休息派，充电更重要。"
  },
  // ============ L2 补充题 - 减少社会期望偏差 (Q78-Q83) ============
  "Q78": {
    "A": "社交充电型，人越多越嗨。",
    "B": "看情况决定，灵活派。",
    "C": "独处充电型，诚实面对。",
    "D": "边界清晰，懂得拒绝。"
  },
  "Q79": {
    "A": "脑洞大开型，创意无限。",
    "B": "务实创意派，落地能力强。",
    "C": "优化型选手，细节打磨。",
    "D": "评估型，谨慎但可靠。"
  },
  "Q80": {
    "A": "社交达人，天生爱交朋友。",
    "B": "暖心派，照顾别人感受。",
    "C": "连接者，喜欢牵线搭桥。",
    "D": "慢热型，诚实表达。"
  },
  "Q81": {
    "A": "随叫随到，朋友第一。",
    "B": "平衡型，懂得安排。",
    "C": "有边界，合理优先级。",
    "D": "诚实选择，不勉强自己。"
  },
  "Q82": {
    "A": "阳光充电型，活力满满。",
    "B": "独享型，享受独处时光。",
    "C": "宅家派，舒适最重要。",
    "D": "睡眠优先，补觉才是正事。"
  },
  "Q83": {
    "A": "直言派，不怕冲突。",
    "B": "委婉型，注重表达方式。",
    "C": "佛系型，懒得争论。",
    "D": "和气派，保持表面和谐。"
  },
  // ============ 强制选择权衡题 (Q84-Q89) ============
  "Q84": {
    "A": "朋友开心比较重要。",
    "B": "稳妥优先，避免踩雷。",
    "C": "好奇心驱动，爱验证。",
    "D": "随和型，去哪都行。"
  },
  "Q85": {
    "A": "社交充电型，越聊越嗨。",
    "B": "平衡派，懂得取舍。",
    "C": "需要恢复，有自知之明。",
    "D": "怕错过型，硬撑也要去。"
  },
  "Q86": {
    "A": "耐心倾听型，朋友优先。",
    "B": "有点疲惫但配合。",
    "C": "正能量转移，技巧派。",
    "D": "解决问题导向，务实。"
  },
  "Q87": {
    "A": "先完成再说，执行力强。",
    "B": "灵感优先，敢于分享。",
    "C": "先验证再提，谨慎创新。",
    "D": "风险规避型，稳妥派。"
  },
  "Q88": {
    "A": "主动融入，热心肠。",
    "B": "尊重独处，不强融。",
    "C": "等时机，不刻意。",
    "D": "同理心强，理解社恐。"
  },
  "Q89": {
    "A": "乐观派，明天会更好。",
    "B": "需要消化，给自己时间。",
    "C": "吐槽发泄型，释放压力。",
    "D": "敏感型，情绪影响久。"
  },
  // ============ 针对易混淆原型的精准区分题 (Q90-Q94) ============
  "Q90": {
    "A": "气氛担当，热情带动。",
    "B": "细心观察，让大家参与。",
    "C": "默默照顾，贴心服务。",
    "D": "等别人先，不擅主导。"
  },
  "Q91": {
    "A": "计划派，一步步推进。",
    "B": "行动派，边做边调整。",
    "C": "讨论派，收集反馈。",
    "D": "想法多但难抉择。"
  },
  "Q92": {
    "A": "鼓励派，正能量加油。",
    "B": "陪伴派，温暖支持。",
    "C": "分析派，提供解决方案。",
    "D": "安静陪伴，无声胜有声。"
  },
  "Q93": {
    "A": "义不容辞，立刻帮忙。",
    "B": "了解清楚再行动。",
    "C": "协调资源，高效帮助。",
    "D": "想帮但不确定怎么帮。"
  },
  "Q94": {
    "A": "深度研究型，追求理解。",
    "B": "稳扎稳打，按部就班。",
    "C": "跳跃式学习，跟着灵感走。",
    "D": "实践派，边学边用。"
  }
};

// 进度反馈（基于完成百分比）
export const progressFeedback: Record<number, string> = {
  0.2: "三分之一了，有点意思。",
  0.5: "过半了，继续。",
  0.8: "快齐活儿了，坚持一下。",
  0.95: "最后一个，马上完事。",
  1.0: "齐活儿，分析完了。"
};

// 原型暗示（12种动物原型）
export const prototypeHintTexts: Record<string, string> = {
  "暖心熊": "看起来是温暖挂选手。",
  "机智狐": "有点机灵鬼的意思。",
  "定心大象": "稳当型选手，靠谱。",
  "隐身猫": "暗中观察型选手。",
  "灵感章鱼": "点子不少，创意型。",
  "太阳鸡": "阳光普照型选手。",
  "开心柯基": "快乐小狗型选手。",
  "夸夸豚": "鼓励师类型，会夸人。",
  "稳如龟": "淡定型选手，不急。",
  "淡定海豚": "佛系类型，包容。",
  "织网蛛": "连接型选手，会搭桥。",
  "沉思猫头鹰": "深度思考型选手。"
};

export interface PrototypeHint {
  leadingTraits: TraitKey[];
  hint: string;
}

export const prototypeHints: Record<string, PrototypeHint> = {
  "high_X_high_P": {
    leadingTraits: ["X", "P"],
    hint: "感觉你是个很会带动气氛的人呢！"
  },
  "high_A_high_E": {
    leadingTraits: ["A", "E"],
    hint: "你给人很温暖稳定的感觉~"
  },
  "high_O_high_C": {
    leadingTraits: ["O", "C"],
    hint: "既有创意又有条理，很厉害！"
  },
  "high_E_low_X": {
    leadingTraits: ["E"],
    hint: "你很沉稳，喜欢自己的节奏~"
  },
  "high_A_high_P": {
    leadingTraits: ["A", "P"],
    hint: "你是个很暖心的开心果！"
  },
  "high_C_high_E": {
    leadingTraits: ["C", "E"],
    hint: "靠谱又稳重，值得信赖！"
  },
  "high_O_low_X": {
    leadingTraits: ["O"],
    hint: "内心世界很丰富呢~"
  }
};

export interface MilestoneConfig {
  position: number;
  message: string;
  xiaoyueMood: 'thinking' | 'excited' | 'encouraging' | 'curious';
  animation?: string;
}

export const milestoneConfigs: MilestoneConfig[] = [
  {
    position: 5,
    message: "嗯嗯，开始有点懂你了~",
    xiaoyueMood: 'curious',
    animation: 'bounce'
  },
  {
    position: 8,
    message: "越来越清晰啦！快成型了~",
    xiaoyueMood: 'encouraging',
    animation: 'pulse'
  },
  {
    position: 11,
    message: "最后几题确认一下~",
    xiaoyueMood: 'excited',
    animation: 'wiggle'
  }
];

export function getOptionFeedback(questionId: string, optionValue: string): string | undefined {
  return xiaoyueFeedback[questionId]?.[optionValue];
}

export function getMilestoneMessage(questionNumber: number): MilestoneConfig | undefined {
  return milestoneConfigs.find(m => m.position === questionNumber);
}

export function getProgressFeedback(progress: number): string | undefined {
  const milestones = [0.2, 0.5, 0.8, 0.95, 1.0];
  for (const milestone of milestones) {
    if (Math.abs(progress - milestone) < 0.05) {
      return progressFeedback[milestone];
    }
  }
  return undefined;
}

export function getPrototypeHintByName(archetypeName: string): string | undefined {
  return prototypeHintTexts[archetypeName];
}

export function getPrototypeHint(traits: Record<TraitKey, number>): PrototypeHint | undefined {
  const entries = Object.entries(traits) as [TraitKey, number][];
  entries.sort((a, b) => b[1] - a[1]);
  
  const topTraits = entries.slice(0, 2).map(([trait]) => trait);
  const lowTraits = entries.slice(-2).map(([trait]) => trait);
  
  if (topTraits.includes('X') && topTraits.includes('P')) {
    return prototypeHints['high_X_high_P'];
  }
  if (topTraits.includes('A') && topTraits.includes('E')) {
    return prototypeHints['high_A_high_E'];
  }
  if (topTraits.includes('O') && topTraits.includes('C')) {
    return prototypeHints['high_O_high_C'];
  }
  if (topTraits.includes('A') && topTraits.includes('P')) {
    return prototypeHints['high_A_high_P'];
  }
  if (topTraits.includes('C') && topTraits.includes('E')) {
    return prototypeHints['high_C_high_E'];
  }
  if (topTraits.includes('E') && lowTraits.includes('X')) {
    return prototypeHints['high_E_low_X'];
  }
  if (topTraits.includes('O') && lowTraits.includes('X')) {
    return prototypeHints['high_O_low_X'];
  }
  
  return undefined;
}
