è¿™ä¸ªæ€è·¯**éå¸¸ç²¾å‡†**ï¼ä½ å·²ç»è§¦åŠäº† GitHub Actions è°ƒè¯•ä¸­æœ€â€œç„å­¦â€çš„éƒ¨åˆ†ï¼š**æ•°æ®æ±¡æŸ“**ã€‚

ä½ è¯´å¾—å¯¹ï¼Œè¿™ä¸ªæŠ¥é”™ä¸æ˜¯å› ä¸ºä½ çš„ `cicd.yml` å†™é”™äº†ï¼Œè€Œæ˜¯å› ä¸º `metadata-action` ä»ä½ çš„ **GitHub ä»“åº“è®¾ç½®**é‡ŒæŠ“å–äº†å¸¦å¼•å·çš„å­—ç¬¦ä¸²ï¼Œç„¶ååƒâ€œæŠ•æ¯’â€ä¸€æ ·ä¼ ç»™äº†ä¸‹ä¸€æ­¥ã€‚

---

### ğŸ” æ·±åº¦è§£æï¼šä¸ºä»€ä¹ˆ Description ä¼šâ€œæŠ•æ¯’â€ï¼Ÿ

å½“ä½ ä½¿ç”¨ `docker/metadata-action` æ—¶ï¼Œå®ƒä¼šé»˜è®¤å°è¯•ç”Ÿæˆä¸€ç³»åˆ— [OCI æ ‡å‡†æ ‡ç­¾](https://github.com/opencontainers/image-spec/blob/main/annotations.md)ã€‚
å…¶ä¸­ä¸€ä¸ªæ ‡ç­¾æ˜¯ `org.opencontainers.image.description`ã€‚

**æŠ¥é”™é“¾è·¯å¦‚ä¸‹ï¼š**

1. ä½ åœ¨ GitHub ä»“åº“çš„ **About** é¡µé¢å†™äº†æè¿°ï¼Œæ¯”å¦‚ï¼š`JoyJoin "AI" Platform`ã€‚
2. `metadata-action` æŠ“åˆ°äº†å®ƒï¼Œç”Ÿæˆäº† `labels` å­—ç¬¦ä¸²ã€‚
3. `build-push-action` æ”¶åˆ°è¿™ä¸ªå­—ç¬¦ä¸²æ—¶ï¼Œè§£æåˆ°äº† `"AI"` é‡Œçš„é‚£ä¸ªåŒå¼•å·ã€‚
4. è§£æå™¨ä»¥ä¸ºè¿™æ˜¯æ ‡ç­¾çš„å¼€å¤´ï¼Œç»“æœä¸€ç›´åˆ°æœ€åä¹Ÿæ²¡æ‰¾åˆ°å¯¹åº”çš„ç»“å°¾å¼•å·ï¼Œäºæ˜¯æŠ¥é”™ï¼š**Quote Not Closed**ã€‚

---

### ğŸ› ï¸ ç°åœ¨çš„æ“ä½œå»ºè®®ï¼šåŒç®¡é½ä¸‹

ä¸ºäº†ä¿è¯ä½ çš„æµæ°´çº¿å½»åº•å˜ç»¿ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªâ€œå¼•å·ç‚¸å¼¹â€æ‹†æ‰ï¼Œé¡ºä¾¿æŠŠåˆšæ‰é‚£ä¸ª `index.html` çš„è·¯å¾„é—®é¢˜ä¹Ÿä¿®äº†ã€‚

#### 1. ä»“åº“ç«¯çš„â€œç‰©ç†æ‹†å¼¹â€ (æœ€å¿«)

å»ä½ çš„ GitHub é¡¹ç›®ä¸»é¡µï¼Œç‚¹å‡»å³ä¸Šè§’çš„ **Settings** é½¿è½®ï¼Œæ£€æŸ¥ **Description**ï¼š

* å¦‚æœé‡Œé¢æœ‰ `"` (åŒå¼•å·)ï¼Œç›´æ¥åˆ æ‰å®ƒæˆ–è€…æ”¹æˆ `'` (å•å¼•å·)ã€‚
* å³ä½¿æ²¡æœ‰å¼•å·ï¼Œå¦‚æœæè¿°å¤ªé•¿æˆ–è€…åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚æ¢è¡Œï¼‰ï¼Œä¹Ÿå»ºè®®å…ˆæ¸…ç©ºæµ‹è¯•ã€‚

#### 2. Workflow ç«¯çš„â€œé€»è¾‘æ‹†å¼¹â€ (æœ€ç¨³)

æŒ‰ç…§ä½ æ‰¾åˆ°çš„æ–¹æ³•ï¼Œä¿®æ”¹ `build-api` ä»»åŠ¡ã€‚**æˆ‘ä¹Ÿå¼ºçƒˆå»ºè®®å…ˆå»æ‰ `labels**`ï¼Œå› ä¸ºå¯¹äºå’±ä»¬ç°åœ¨çš„å¼€å‘é˜¶æ®µï¼Œé•œåƒæ ‡ç­¾ï¼ˆLabelsï¼‰å¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œèƒ½è·‘é€šæ‰æ˜¯ç‹é“ã€‚

**è¯·ä¿®æ”¹ `build-api` çš„è¿™ä¸€æ®µï¼š**

```yaml
      - name: Build and push
        uses: docker/build-push-action@v5
        with:
          context: .
          file: apps/server/Dockerfile
          push: ${{ github.event_name != 'pull_request' }}
          # åªä¿ç•™ tagsï¼Œå»æ‰ labels
          tags: ${{ steps.meta.outputs.tags }}
          # labels: ${{ steps.meta.outputs.labels }}  <-- æ³¨é‡Šæ‰æˆ–åˆ æ‰è¿™è¡Œ

```

---

### âš ï¸ åˆ«å¿˜äº†é‚£ä¸ª `index.html` çš„æŠ¥é”™ï¼

åœ¨ä½ åˆšæ‰å‘çš„æ—¥å¿—é‡Œï¼Œ`build-user` ä»»åŠ¡è¿˜æŠ¥äº†ä¸€ä¸ªé”™ï¼š

> `error during build: Could not resolve entry module "index.html"`

è¿™æ„å‘³ç€å³ä½¿ä½ ä¿®å¥½äº†å¼•å·ï¼Œè¿™ä¸€æ­¥è¿˜æ˜¯ä¼šå´©ã€‚**è¿™æ˜¯å› ä¸ºè·¯å¾„è¿˜æ²¡å¯¹é½ã€‚**

**è¯·ç¡®ä¿ `build-user` æ˜¯è¿™æ ·å†™çš„ï¼š**

```yaml
      - name: Build User Client
        run: |
          cd apps/user-client
          npm install  # å¿…é¡»åœ¨å­ç›®å½•æ‰§è¡Œï¼Œç¡®ä¿ Vite æ’ä»¶éƒ½è£…ä¸Šäº†
          npx vite build --emptyOutDir 

```

*æç¤ºï¼šå¦‚æœ `index.html` åœ¨ `apps/user-client/index.html`ï¼Œé‚£ä¹ˆæ‰§è¡Œ `vite build` å¿…é¡»åœ¨ `apps/user-client` ç›®å½•ä¸‹ã€‚*

---

### âœ… æ€»ç»“ä½ ç°åœ¨çš„ Debug æµç¨‹

1. **æ”¹ä»“åº“æè¿°**ï¼šåˆ æ‰ GitHub About é‡Œçš„åŒå¼•å·ã€‚
2. **æ”¹ `cicd.yml**`ï¼š
* åˆ æ‰ `labels: ${{ steps.meta.outputs.labels }}`ã€‚
* æ£€æŸ¥ `build-user` çš„ `path` æ˜¯å¦æ”¹æˆäº† `apps/user-client/dist`ï¼ˆä¹‹å‰çš„ä»»åŠ¡å¤±è´¥ä¹Ÿå› ä¸ºè¿™ä¸ªï¼‰ã€‚


3. **å†æ¬¡ Push**ã€‚

**è¿™æ¬¡å¦‚æœ API é•œåƒé‚£å—å˜ç»¿äº†ï¼Œå°±è¯´æ˜å’±ä»¬å½»åº•æŠ“ä½äº†é‚£ä¸ªâ€œå¼•å·å¹½çµâ€ï¼å¦‚æœ User Portal è¿˜æ˜¯æŠ¥æ‰¾ä¸åˆ° index.htmlï¼Œä½ å¯ä»¥æˆªä¸€å¼ ä½ æœ¬åœ° `apps/user-client` çš„æ–‡ä»¶ç›®å½•æ ‘å‘ç»™æˆ‘å—ï¼Ÿ**